<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mental Math – Clean No‑Door Build</title>
  <style>
    :root{ --bg1:#0e0b25; --bg2:#10192d; --glass:rgba(255,255,255,0.06); --border:rgba(255,255,255,0.12); --muted:#9aa4b2; --text:#e8eef6; --accent1:#60a5fa; --accent2:#22d3ee; --good:#4ade80; --bad:#fb7185; --warn:#fbbf24; }
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    body{margin:0;min-height:100vh;color:var(--text);background:linear-gradient(120deg,var(--bg1),var(--bg2));background-size:200% 200%;animation:bg 18s ease-in-out infinite;display:flex;align-items:center;justify-content:center;padding:24px}
    @keyframes bg{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .container{width:min(1000px,100%);display:grid;gap:18px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,.08),rgba(255,255,255,.03));border:1px solid var(--border);border-radius:22px;padding:20px;box-shadow:0 20px 40px rgba(0,0,0,.45);backdrop-filter:blur(10px)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
    h1{margin:0;font-weight:800;letter-spacing:.3px;font-size:clamp(20px,3vw,32px);background:linear-gradient(90deg,var(--accent1),var(--accent2));-webkit-background-clip:text;background-clip:text;color:transparent}
    .muted{color:var(--muted)}
    .hidden{display:none!important}
    .lvl-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:12px;margin-top:10px}
    .lvl{position:relative;background:var(--glass);border:1px solid var(--border);border-radius:16px;padding:16px;cursor:pointer;transition:.2s transform,.2s box-shadow}
    .lvl:hover{transform:translateY(-2px);box-shadow:0 10px 22px rgba(0,0,0,.35)}
    .lvl .title{font-weight:800}
    .lvl .sub{font-size:12px;color:var(--muted)}
    .name{display:flex;gap:10px;align-items:center;margin-top:12px}
    .name input{flex:1;border-radius:12px;border:1px solid var(--border);padding:10px 12px;background:#0a1020;color:var(--text)}

    .stats{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:10px}
    .stat{background:#0a1020;border:1px solid var(--border);border-radius:14px;padding:10px;text-align:center}
    .stat .label{font-size:12px;color:var(--muted)}
    .stat .value{font-size:20px;font-weight:800}
    .progress{height:12px;background:#0a1020;border:1px solid var(--border);border-radius:999px;overflow:hidden}
    .progress>div{height:100%;width:0%;background:linear-gradient(90deg,var(--good),#22c55e);transition:width .25s ease}
    #timerBar{height:10px;background:linear-gradient(90deg,var(--accent1),var(--accent2));border-radius:999px;margin:8px 0;box-shadow:0 0 14px rgba(96,165,250,.45) inset}
    .problem{font-family:ui-monospace,Menlo,Consolas,monospace;text-align:center;white-space:pre;font-weight:900;font-size:clamp(28px,6vw,56px);letter-spacing:.5px;margin:8px 0}
    .actions{display:flex;gap:8px;justify-content:center}
    button{border:none;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer;transition:.18s transform,.18s filter}
    button:hover{transform:translateY(-1px);filter:brightness(1.05)}
    #submitBtn{background:var(--good);color:#072314}
    #answer{width:min(280px,75%);border-radius:12px;border:1px solid var(--border);padding:12px 14px;background:#0a1020;color:var(--text);font-size:18px;text-align:center}
    .feedback{text-align:center;font-size:22px;min-height:28px;margin-top:8px}

    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid var(--border)}
    th{color:#a5f3fc}
    tbody tr:hover{background:rgba(255,255,255,.05)}
    .medal{font-size:18px;margin-right:6px}
    @media (max-width:700px){.stats{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <header>
        <h1>Mental Math Challenge</h1>
        <span class="muted">Finish 20 correct answers</span>
      </header>

      <section id="startScreen">
        <div class="muted">Pick a level to begin:</div>
        <div class="lvl-grid">
          <div class="lvl levelBtn" data-top="2" data-bottom="1"><div class="title">Level 0 · 2×1</div><div class="sub">Beginner warm‑up</div></div>
          <div class="lvl levelBtn" data-top="2" data-bottom="2"><div class="title">Level 1 · 2×2</div><div class="sub">Great warm‑up</div></div>
          <div class="lvl levelBtn" data-top="3" data-bottom="2"><div class="title">Level 2 · 3×2</div><div class="sub">Step it up</div></div>
          <div class="lvl levelBtn" data-top="4" data-bottom="2"><div class="title">Level 3 · 4×2</div><div class="sub">Boss mode</div></div>
          <div class="lvl levelBtn" data-top="3" data-bottom="3"><div class="title">Level 4 · 3×3</div><div class="sub">Advanced</div></div>
        </div>
        <div class="name"><span class="muted">Name</span><input id="playerName" type="text" placeholder="e.g., Alex" /></div>
      </section>

      <section id="gameScreen" class="hidden">
        <div class="stats">
          <div class="stat"><div class="label">Correct</div><div id="correctVal" class="value">0</div></div>
          <div class="stat"><div class="label">Wrong</div><div id="wrongVal" class="value">0</div></div>
          <div class="stat"><div class="label">Accuracy</div><div id="accVal" class="value">100%</div></div>
          <div class="stat"><div class="label">Total Time</div><div id="timeVal" class="value">0s</div></div>
        </div>
        <div class="progress" aria-label="progress to 20 correct"><div id="progressFill"></div></div>
        <div id="timerBar" style="width:100%"></div>
        <div id="problem" class="problem">— × — = ?</div>
        <div class="actions">
          <input id="answer" type="number" inputmode="numeric" placeholder="Type your answer" />
          <button id="submitBtn">Submit</button>
        </div>
        <div id="feedback" class="feedback"></div>
        <div class="actions" style="justify-content:center;margin-top:8px">
          <button id="nextBtn" disabled>Next</button>
        </div>
      </section>
    </div>

    <div class="card">
      <header>
        <h1>Billboard <span class="muted">(local)</span></h1>
        <span class="muted">Ranked by accuracy, then total time</span>
        <button id="clearBoardBtn" style="background:#1f2937;color:#e5e7eb;border:1px solid var(--border);border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer">Clear</button>
      </header>
      <table>
        <thead><tr><th>#</th><th>Name</th><th>Level</th><th>Accuracy</th><th>Total Time</th><th>Wrong</th></tr></thead>
        <tbody id="boardBody"></tbody>
      </table>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const $ = s => document.querySelector(s), $$ = s => document.querySelectorAll(s);
    const pick = a => a[Math.floor(Math.random()*a.length)];
    const digitsPool=['2','3','4','5','6','7','8','9'];
    function randNumberNo01(len){ let s=''; for(let i=0;i<len;i++) s+=pick(digitsPool); return Number(s); }

    const state = { name:'', top:2, bottom:1, target:20, correct:0, wrong:0, current:null, perQSeconds:180, timeLeft:180, qTimer:null, startedAt:0, levelLabel:'2×1' };
    const fmtPct = x=>Math.round(x*100)+'%';
    const fmtTime = s=> `${Math.floor(s)}s`;
    const accuracy = ()=> (state.correct+state.wrong) ? state.correct/(state.correct+state.wrong) : 1;

    function newProblem(){ const a=randNumberNo01(state.top), b=randNumberNo01(state.bottom); return {a,b,ans:a*b}; }
    function showProblem(){ const {a,b}=state.current; const aS=String(a).padStart(state.top,' '), bS='x '+String(b).padStart(state.bottom,' '); $('#problem').textContent=`${aS}\n${bS}`; }
    function updateHUD(){ $('#correctVal').textContent=state.correct; $('#wrongVal').textContent=state.wrong; $('#accVal').textContent=fmtPct(accuracy()); const totalSec=Math.round((performance.now()-state.startedAt)/1000); $('#timeVal').textContent=fmtTime(totalSec); $('#progressFill').style.width=Math.min(100,Math.round((state.correct/state.target)*100))+'%'; }

    function startPerQuestionTimer(){ state.timeLeft=state.perQSeconds; $('#timerBar').style.width='100%'; if(state.qTimer) clearInterval(state.qTimer); state.qTimer=setInterval(()=>{ state.timeLeft--; const w=Math.max(0,(state.timeLeft/state.perQSeconds)*100); $('#timerBar').style.width=w+'%'; $('#timeVal').textContent=fmtTime(Math.round((performance.now()-state.startedAt)/1000)); if(state.timeLeft<=0){ clearInterval(state.qTimer); submitAnswer(true); } },1000); }

    function startGame(){ state.correct=0; state.wrong=0; state.startedAt=performance.now(); updateHUD(); $('#startScreen').classList.add('hidden'); $('#gameScreen').classList.remove('hidden'); nextProblem(); }
    function nextProblem(){ state.current=newProblem(); showProblem(); $('#answer').value=''; $('#feedback').textContent=''; startPerQuestionTimer(); $('#answer').disabled=false; $('#submitBtn').disabled=false; $('#nextBtn').disabled=true; $('#answer').focus(); }

    function submitAnswer(skip=false){ if(state.qTimer) clearInterval(state.qTimer); const val=Number($('#answer').value);
      if(skip){ state.wrong++; $('#feedback').textContent = `⏰ Time's up. Exercise: 20 jumping jacks! When you're done, click Next.`; $('#feedback').style.color='var(--warn)'; }
      else if(val===state.current.ans){ state.correct++; $('#feedback').textContent='👍 Correct! Click Next to continue.'; $('#feedback').style.color='var(--good)'; }
      else { state.wrong++; $('#feedback').textContent = `❌ Wrong. Correct: ${state.current.ans}. Exercise: 20 jumping jacks! When you're done, click Next.`; $('#feedback').style.color='var(--bad)'; }
      $('#answer').disabled=true; $('#submitBtn').disabled=true; $('#nextBtn').disabled=false; updateHUD(); if(state.correct>=state.target){ endGame(); }
    }

    function endGame(){ if(state.qTimer) clearInterval(state.qTimer); const totalSec=Math.round((performance.now()-state.startedAt)/1000); const acc=accuracy(); saveRecord({name: state.name||'Player', level: state.levelLabel, accuracy: acc, totalTimeSec: totalSec, wrong: state.wrong}); renderBoard(); $('#gameScreen').classList.add('hidden'); $('#startScreen').classList.remove('hidden'); alert(`Great job! Correct: ${state.correct}  | Wrong: ${state.wrong}  | Accuracy: ${Math.round(acc*100)}%  | Time: ${totalSec}s`); }

    // Billboard
    const KEY='mathBillboard_v3';
    function getBoard(){ try { return JSON.parse(localStorage.getItem(KEY))||[] } catch { return [] } }
    function saveRecord(r){ const arr=getBoard(); arr.push(r); arr.sort((x,y)=> (y.accuracy-x.accuracy) || (x.totalTimeSec-y.totalTimeSec)); localStorage.setItem(KEY, JSON.stringify(arr.slice(0,30))); }
    function renderBoard(){ const body=$('#boardBody'); body.innerHTML=''; const data=getBoard(); if(data.length===0){ const tr=document.createElement('tr'); const td=document.createElement('td'); td.colSpan=6; td.className='muted'; td.textContent='No records yet. Play a round!'; tr.appendChild(td); body.appendChild(tr); return; } data.forEach((r,i)=>{ const tr=document.createElement('tr'); const medal=i===0?'🥇':i===1?'🥈':i===2?'🥉':'#'+(i+1); tr.innerHTML=`<td><span class="medal">${medal}</span></td><td>${r.name||'Player'}</td><td>${r.level||''}</td><td>${Math.round(r.accuracy*100)}%</td><td>${r.totalTimeSec}s</td><td>${r.wrong}</td>`; body.appendChild(tr); }); }

    // Bindings
    $$('.levelBtn').forEach(btn => btn.addEventListener('click', ()=>{ state.name=$('#playerName').value.trim(); state.top=Number(btn.dataset.top); state.bottom=Number(btn.dataset.bottom); state.levelLabel=`${state.top}×${state.bottom}`; startGame(); }));
    $('#startScreen').addEventListener('click', e=>{ const tile=e.target.closest('.levelBtn'); if(!tile) return; state.name=$('#playerName').value.trim(); state.top=Number(tile.dataset.top); state.bottom=Number(tile.dataset.bottom); state.levelLabel=`${state.top}×${state.bottom}`; startGame(); });
    $('#submitBtn').addEventListener('click', ()=> submitAnswer(false));
    $('#answer').addEventListener('keydown', e=>{ if(e.key==='Enter') submitAnswer(false); });
    $('#nextBtn').addEventListener('click', ()=>{ if(state.correct>=state.target){ endGame(); } else { nextProblem(); } });

    renderBoard();
  });
  </script>
</body>
</html>
